#include <iostream>
#include <time.h>
#include <cstdlib>
#include <conio.h>
#include <stdio.h>
#include <windows.h>
#define color SetConsoleTextAttribute

using namespace std;

HANDLE hconsole = GetStdHandle( STD_OUTPUT_HANDLE );

int aleatorio()
{
	return (1 + rand() % 5) ;
}

void crush_de_candys(int tablero[10][10])
{
	bool flag=0;
	int counter, aux;
	
	/*Destruccion de caramelos en horizontal ---*/
	while(flag)
	{
		for(int i=0 ; i<10 ; i++)
		{
			for(int j=0 ; j<10 ; j++)
			{
				if(j==0)
				{
					count = 0;
					aux = tablero[i][j];
				}
				else if(tablero[i][j] != aux)
				{
					if(count => 3)
					{
						for(int k=count; k<0 ; k++)
						{
							tablero[i][j-k] = 0;
						}	
					}
					count = 0;
					aux = tablero[i][j];
				}
				else
				{
					count ++;
				}
			}
		}
	}
	
	while(flag)
	{
		
	}
	
	
}

void mostrar_tablero(int tablero[10][10], int cursi, int cursj, int cursi1, int cursj1, int movimientos)
{
	printf("%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c\n", 201, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 187);
	for(int i=0; i<10 ; i++)
	{
		printf("%c", 186);
		for(int j=0 ; j<10 ; j++)
		{	
			color(hconsole, 15);
			cout << " ";
			
			if(i==cursi1 && j==cursj1) color(hconsole, 31);
			else if(i==cursi && j==cursj) color(hconsole, 240);
			else color(hconsole, 15);
			
			if(tablero[i][j]==1) cout << "@";
			else if(tablero[i][j]==2) cout << "#";
			else if(tablero[i][j]==3) cout << "X";
			else if(tablero[i][j]==4) cout << "H";
			else if(tablero[i][j]==5) cout << "C";
			else cout << "0";
		}
		color(hconsole, 15);
		printf(" %c\n", 186);
		if(i!=9) printf("%c                     %c\n", 186, 186);
	}
	printf("%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c\n\n", 200, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 205, 188);
	cout << "Movimientos: " << movimientos << endl << endl;
}

void vaciar_tablero(int tablero[10][10])
{
	for(int i=0; i<10 ; i++)
	{
		for(int j=0; j<10 ; j++)
		{
			tablero[i][j] = 0;
		}
	}
}

void cargar_tablero(int tablero[10][10])
{
	for(int i=0; i<10 ; i++)
	{
		for(int j=0 ; j<10 ; j++)
		{
			if(tablero[i][j] == 0) tablero[i][j] = aleatorio();
		}
	}
}

int main()
{
	char tecla, tecla1;
	int cursi, cursj, cursi1, cursj1, aux, score, movimientos=0;
	bool flag;
	
	srand(time(NULL));
	
	int tablero[10][10];
	vaciar_tablero(tablero);
	cargar_tablero(tablero);
	
	while(1)
	{
		cursi1 = cursj1 = -1;
		system("cls");
		mostrar_tablero(tablero, cursi, cursj, cursi1, cursj1, movimientos);
		
		tecla = getch();
		
		switch(tecla)
		{
			case 72://FLECHA DE ARRIBA
				if(cursi==0) cursi = 9;
				else cursi --;
				break;
				
			case 80://FLECHA DE ABAJO
				if(cursi==9) cursi = 0;
				else cursi ++;
				break;
				
			case 75://FLECHA DE LA IZQUIERDA
				if(cursj==0) cursj == 9;
				else cursj --;
				break;
			
			case 77://FLECHA DE LA DERECHA
				if(cursj==9) cursj == 0;
				else cursj ++;
				break;
				
			case 13://ENTER
				tecla1=10;
				cursi1 = cursi;
				cursj1 = cursj;
				while(tecla1!=13)
				{
					system("cls");
					mostrar_tablero(tablero, cursi, cursj, cursi1, cursj1, movimientos);
				
					tecla1 = getch();
				
					switch(tecla1)	//HABIENDO SELECCIONADO UNA FICHA TOCA SELECCIONAR LA SEGUNDA
					{
						case 72://FLECHA DE ARRIBA
							if(cursi1==0) cursi1 = 9;
							else if(cursi - 1 != cursi1) cursi1 --;
							break;
					
						case 80://FLECHA DE ABAJO
							if(cursi1==9) cursi1 = 0;
							else if(cursi + 1 != cursi1) cursi1 ++;
							break;
				
						case 75://FLECHA DE LA IZQUIERDA
							if(cursj1==0) cursj1 = 9;
							else if(cursj - 1 != cursj1) cursj1 --;
							break;
			
						case 77://FLECHA DE LA DERECHA
							if(cursj1==9) cursj1 = 0;
							else if(cursj + 1 != cursj1) cursj1 ++;
							break;
							
						case 13://ENTER
							aux = tablero[cursi1][cursj1];
							tablero[cursi1][cursj1] = tablero[cursi][cursj];
							tablero[cursi][cursj] = aux;
							movimientos ++;
							break;
					}
				}
				break;
		}
	}
}



